<!DOCTYPE html>
<html>
<head>
    <!-- <meta charset="GB2312"> -->
    <title>Hello TWaver Full</title>
    <script type="text/javascript" src="../lib/twaver.js"></script>
    <script type="text/javascript">
        var network = new twaver.network.Network();
        var box = network.getElementBox();

        function init() {
          this.registImages();

          registImages: function () {
              this.registerImage("images/antenna.png");
              this.registerImage("images/cartridge_system.png");
              this.registerImage("images/cloud.png");
              this.registerImage("images/mainframe.png");
              this.registerImage("images/modem.png");
              this.registerImage("images/msc.png");
              this.registerImage("images/phone.png");
              this.registerImage("images/router.png");
              this.registerImage("images/router2.png");
              this.registerImage("images/satellite_antenna.png");
              this.registerImage("images/terminal.png");
              this.registerImage("images/testing.png");
              this.registerImage("images/tw130.png");
              this.registerImage("images/wdm.png");

              this.registerImage("images/att1.png");
              this.registerImage("images/att2.png");
              this.registerImage("images/att3.png");
              this.registerImage("images/rackImage.png");
              this.registerImage("images/portUpImage.png");
              this.registerImage("images/portDownImage.png");
          },
          registerImage: function (url) {
              this.registerImage(url, this.network);
          },
          registerImage: function (url, svg) {
              var image = new Image();
              image.src = url;
              var views = arguments;
              var that = this;
              image.onload = function () {
                  twaver.Util.registerImage(that.getImageName(url), image, image.width, image.height, svg);
                  image.onload = null;
                  for (var i = 1; i < views.length; i++) {
                      var view = views[i];
                      if (view.invalidateElementUIs) {
                          view.invalidateElementUIs();
                      }
                      if (view.invalidateDisplay) {
                          view.invalidateDisplay();
                      }
                  }
              };
          },
          getImageName: function (url) {
              var index = url.lastIndexOf('/');
              var name = url;
              if (index >= 0) {
                  name = url.substring(index + 1);
              }
              index = name.lastIndexOf('.');
              if (index >= 0) {
                  name = name.substring(0, index);
              }
              return name;
          }
          // var seriJson = {"version":"5.1.8","platform":"html5","images":{},"dataBox":{"class":"twaver.ElementBox","layers":[{"name":"Default","visible":true,"editable":true,"movable":true}]},"datas":[{"class":"twaver.Node","ref":0,"p":{"name":"TWaver Router","image":"tw130","location":{"x":356,"y":139}},"s":{"label.yoffset":-75}},{"class":"twaver.Node","ref":1,"p":{"name":"DATA","image":"cloud","location":{"x":246,"y":145}},"s":{"label.yoffset":-30}},{"class":"twaver.Link","ref":2,"p":{"fromNode":1,"toNode":0},"s":{"link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":3,"p":{"name":"PSTN","image":"cloud","location":{"x":246,"y":209}},"s":{"label.yoffset":-30}},{"class":"twaver.Link","ref":4,"p":{"fromNode":3,"toNode":0},"s":{"link.type":"orthogonal.H.V","link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":5,"p":{"name":"Scrambler","image":"router","location":{"x":175,"y":157}}},{"class":"twaver.Link","ref":6,"p":{"fromNode":5,"toNode":1},"s":{"link.flow":true,"link.flow.converse":true,"link.pattern":[5,5],"link.color":"yellow","vector.outline.color":"#FFFFFF","link.width":5}},{"class":"twaver.Node","ref":7,"p":{"image":"router","location":{"x":106,"y":95}}},{"class":"twaver.Link","ref":8,"p":{"fromNode":7,"toNode":5},"s":{"link.type":"orthogonal.H.V","link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":9,"p":{"image":"router","location":{"x":106,"y":107}}},{"class":"twaver.Link","ref":10,"p":{"fromNode":9,"toNode":5},"s":{"link.type":"orthogonal.H.V","link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":11,"p":{"image":"router","location":{"x":106,"y":119}}},{"class":"twaver.Link","ref":12,"p":{"fromNode":11,"toNode":5},"s":{"link.type":"orthogonal.H.V","link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":13,"p":{"image":"router","location":{"x":106,"y":131}}},{"class":"twaver.Link","ref":14,"p":{"fromNode":13,"toNode":5},"s":{"link.type":"orthogonal.H.V","link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":15,"p":{"name":"Encoder","image":"router","location":{"x":106,"y":143}}},{"class":"twaver.Link","ref":16,"p":{"fromNode":15,"toNode":5},"s":{"link.type":"orthogonal.H.V","link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":17,"p":{"image":"router","location":{"x":106,"y":222}}},{"class":"twaver.Link","ref":18,"p":{"fromNode":17,"toNode":5},"s":{"link.type":"orthogonal.H.V","link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":19,"p":{"image":"router","location":{"x":106,"y":242}}},{"class":"twaver.Link","ref":20,"p":{"fromNode":19,"toNode":5},"s":{"link.type":"orthogonal.H.V","link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":21,"p":{"name":"Satellite Feed","image":"satellite_antenna","location":{"x":31,"y":90}}},{"class":"twaver.Node","ref":22,"p":{"name":"Off Air","image":"antenna","location":{"x":33,"y":183}}},{"class":"twaver.Node","ref":23,"p":{"name":"Programming","image":"msc","location":{"x":33,"y":291}}},{"class":"twaver.Node","ref":24,"p":{"name":"Pre-Amp","image":"cartridge_system","location":{"x":191,"y":292}},"s":{"icons.names":["att1","att2","att3"],"icons.colors":[null,"#00FF00","#0000FF"]}},{"class":"twaver.Node","ref":25,"p":{"name":"V-OLT","alarmState":{"n":{"Critical":5}},"image":"router","location":{"x":105,"y":302}}},{"class":"twaver.Link","ref":26,"p":{"fromNode":25,"toNode":24},"s":{"icons.names":["att2"],"link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":27,"p":{"name":"WDM","image":"wdm","location":{"x":432,"y":146}}},{"class":"twaver.Link","ref":28,"p":{"fromNode":24,"toNode":27},"s":{"link.type":"orthogonal.H.V","vector.outline.color":"#FF00FF","link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Link","ref":29,"p":{"fromNode":0,"toNode":27},"s":{"link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":30,"p":{"alarmState":{"n":{"Major":1}},"image":"testing","location":{"x":476,"y":161}}},{"class":"twaver.Link","ref":31,"p":{"fromNode":30,"toNode":27},"s":{"link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":32,"p":{"name":"WDM","image":"wdm","location":{"x":516,"y":146}}},{"class":"twaver.Link","ref":33,"p":{"fromNode":30,"toNode":32},"s":{"link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":34,"p":{"name":"ONT","image":"mainframe","location":{"x":555,"y":196}}},{"class":"twaver.Link","ref":35,"p":{"fromNode":34,"toNode":32},"s":{"link.type":"orthogonal.H.V","icons.names":["att2"],"link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":36,"p":{"name":"Modem","image":"modem","location":{"x":560,"y":98}}},{"class":"twaver.Node","ref":37,"p":{"name":"PC","location":{"x":651,"y":64}}},{"class":"twaver.Link","ref":38,"p":{"fromNode":37,"toNode":36},"s":{"link.type":"orthogonal.H.V","link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":39,"p":{"name":"STB","image":"router2","location":{"x":614,"y":122}}},{"class":"twaver.Link","ref":40,"p":{"fromNode":39,"toNode":36},"s":{"link.type":"orthogonal.H.V","link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":41,"p":{"name":"IPTV/SDV","image":"terminal","location":{"x":666,"y":152}}},{"class":"twaver.Link","ref":42,"p":{"fromNode":41,"toNode":39},"s":{"link.type":"orthogonal.H.V","link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":43,"p":{"name":"Phone","image":"phone","location":{"x":648,"y":223}}},{"class":"twaver.Link","ref":44,"p":{"fromNode":43,"toNode":34},"s":{"link.type":"orthogonal.H.V","link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":45,"p":{"name":"PC","location":{"x":648,"y":266}}},{"class":"twaver.Link","ref":46,"p":{"fromNode":45,"toNode":34},"s":{"link.type":"orthogonal.H.V","link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":47,"p":{"name":"STB","image":"router2","location":{"x":609,"y":324}}},{"class":"twaver.Link","ref":48,"p":{"fromNode":47,"toNode":34},"s":{"link.type":"orthogonal.H.V","link.color":"#C0C0C0","link.width":5}},{"class":"twaver.Node","ref":49,"p":{"name":"IPTV/SDV","image":"terminal","location":{"x":641,"y":357}}},{"class":"twaver.Link","ref":50,"p":{"fromNode":49,"toNode":47},"s":{"link.type":"orthogonal.H.V","link.color":"#C0C0C0","link.width":5}}]};
          
          // // seriJson.images={
          // //   "antenna" :"images/antenna.png",
          // //   "cartridge_system":"images/cartridge_system.png",
          // //   "cloud":"images/cloud.png",
          // //   "mainframe":"images/mainframe.png",
          // //   "modem":"images/modem.png",
          // //   "msc":"images/msc.png",
          // //   "phone":"images/phone.png",
          // //   "router":"images/router.png",
          // //   "router2":"images/router2.png",
          // //   "satellite_antenna":"images/satellite_antenna.png",
          // //   "terminal":"images/terminal.png",
          // //   "testing":"images/testing.png",
          // //   "tw130":"images/tw130.png",
          // //   "wdm":"images/wdm.png",
          // //   "att1":"images/att1.png",
          // //   "att2":"images/att2.png",
          // //   "att3":"images/att3.png",
          // //   "rackImage":"images/rackImage.png",
          // //   "portUpImage":"images/portUpImage.png",
          // //   "portDownImage":"images/portDownImage.png"
          // // };
          // var serializer = new twaver.JsonSerializer(box);
          // serializer.serialize();
          // serializer.deserialize(JSON.stringify(seriJson));

          // document.body.appendChild(network.getView());
          // network.adjustBounds({ x: 0, y: 0, width: 1000, height: 1000 });
        }



    </script>
</head>
<body  onload="init()" style="margin:0;">
</body>
</html>